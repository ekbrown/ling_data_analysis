<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Lesson Plans for Linguistic Data Analysis with R - Mixed-effects linear regression</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../EKB_2023_icon.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../lessons/t-test.html">Inferential stats</a></li><li class="breadcrumb-item"><a href="../lessons/mixed-effects-linear.html">Mixed-effects linear regression</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Lesson Plans for Linguistic Data Analysis with R</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Basics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/r_rstudio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R and RStudio</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/programming_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Programming basics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/data_structures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data structures in R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/File_IO.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">File I/O in R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/regexes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Regular expressions</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Frequency</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/create_freq.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Creating frequency lists</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/webscrape_freq.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Webscrape frequencies</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/quanteda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">quanteda</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Wrangling</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/wrangling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Wrangling</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Visualization</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Visualization</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Reproducible research</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quarto documents</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
 <span class="menu-text">Other languages</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/python.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Other languages</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
 <span class="menu-text">Descriptive stats</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/outliers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Detecting outliers</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
 <span class="menu-text">Inferential stats</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/t-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">t-test, Wilcoxon test</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ANOVA</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/chi-square.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chi-square test</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/linear_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linear regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/interaction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interaction between explanatory variables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/transform.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Transform continuous variables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/multicollinearity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multicollinearity</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/logistic_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Logistic regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/mixed-effects-linear.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Mixed-effects linear regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/regression_assumptions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Regression assumptions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lessons/mixed-effects-logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">mixed-effects-logistic</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#random-effects" id="toc-random-effects" class="nav-link active" data-scroll-target="#random-effects">Random effects</a></li>
  <li><a href="#word-durations" id="toc-word-durations" class="nav-link" data-scroll-target="#word-durations">Word durations</a></li>
  <li><a href="#load-dataset" id="toc-load-dataset" class="nav-link" data-scroll-target="#load-dataset">Load dataset</a></li>
  <li><a href="#with-random-intercepts" id="toc-with-random-intercepts" class="nav-link" data-scroll-target="#with-random-intercepts">With random intercepts</a></li>
  <li><a href="#without-random-intercepts" id="toc-without-random-intercepts" class="nav-link" data-scroll-target="#without-random-intercepts">Without random intercepts</a></li>
  <li><a href="#random-slopes-and-intercepts" id="toc-random-slopes-and-intercepts" class="nav-link" data-scroll-target="#random-slopes-and-intercepts">Random slopes and intercepts</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Mixed-effects linear regression</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="random-effects" class="level1">
<h1>Random effects</h1>
<p>Random effects in a linear regression model control for the variability attributable to the specific members of a population that happened to be selected for our random sample. To take an example, let’s say we have a dataset of 2,500 tokens of word durations that were extracted from the speech of six speakers. Each speaker contributed several hundreds tokens of word durations. A handful of predictor variables have been shown in the literature to affect word durations:</p>
<ul>
<li>word length: longer words take longer to articulate</li>
<li>frequency: more frequent words are generally spoken quicker</li>
<li>speech rate: when a speaker is speaking quickly at a given point in a conversation, their words will have shorter durations</li>
<li>position near the end of the utterance: speech rate at the end of utterances usually slows down</li>
<li>previous mention: words previously spoken in a conversation are usually spoken quicker than first mentions<br></li>
</ul>
<p>In addition to those predictor variables, we should also control for that fact that not all speakers talk at the same speed. Some speakers talk faster than others, and some speakers are painfully slow with their speech. It could be the case that Bobby is simply a slow speaker, while Luisa is a fast talker, and as such, Bobby’s word durations are longer overall while Luisa’s are shorter when compared to the other speakers in the dataset.</p>
<p>To summarize, random effects help us control for the variability in the response variable that is attributable to the individuals sampled from the population, before measuring the effect, if any, from the explanatory variables in the model.</p>
<p>The non-random effect explanatory variables are called fixed effects.</p>
</section>
<section id="word-durations" class="level1">
<h1>Word durations</h1>
<p>Let’s look at a sample of word durations from the <a href="https://buckeyecorpus.osu.edu/">Buckeye Corpus of English</a>. The “Word_dur_Buckeye.csv” file in the CMS has all word durations of content words spoken by six speakers (from among the total 40 speakers in the corpus). The dataset has the following columns:</p>
<ul>
<li>file: the filename that acts as an ID of the speaker</li>
<li>wd: orthographic representation of the word</li>
<li>wd_dur: duration of the word in seconds</li>
<li>segments: the sound segments actually pronounced (phonetic representation, not phonemic)</li>
<li>n_segments: word length as the number of segments pronounced</li>
<li>n_syl: word length as the number of syllables</li>
<li>pos: part-of-speech tag</li>
<li>spch_rate: speech rate in segments per second of the part of the utterance from after the word to the end of the utterance</li>
<li>wd_freq: word frequency from the <a href="https://opus.nlpl.eu/OpenSubtitles-v2018.php">OpenSubtitles</a> English data dump (only 1991-2000) as a Laplace smoothed numbers (see <a href="https://link.springer.com/article/10.3758/s13428-012-0270-5">here</a>)</li>
<li>dist_end_iu: the distance in number of words that the word falls from the end of the utterance</li>
<li>pre_mention: whether the word was previously mentioned in the conversation (“yes” or “no”)</li>
</ul>
</section>
<section id="load-dataset" class="level1">
<h1>Load dataset</h1>
<p>Let’s load the dataset and print the first six rows (the default quantity of <a href="https://www.rdocumentation.org/packages/utils/versions/3.6.2/topics/head">head()</a>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"tidyverse"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.4.4     ✔ tibble    3.2.1
✔ lubridate 1.9.2     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>buck <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"/Users/ekb5/Documents/data_analysis/datasets/Word_dur_Buckeye.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 2537 Columns: 11
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (5): file, wd, segments, pos, pre_mention
dbl (6): wd_dur, n_segments, n_syl, spch_rate, wd_freq, dist_end_iu

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(buck)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 11
  file  wd       wd_dur segments        n_segments n_syl pos   spch_rate wd_freq
  &lt;chr&gt; &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;                &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;
1 s01   show      0.195 ['sh', 'ow']             2     1 VBP       14.2  4.09e-4
2 s06   everyone  0.418 ['eh', 'v', 'r…          7     3 NN        13.2  2.21e-4
3 s01   is        0.103 ['uh', 'z']              2     1 VBZ       13.9  8.58e-3
4 s01   national  0.394 ['n', 'ae', 's…          5     2 JJ        14.5  3.99e-5
5 s01   catholic  0.402 ['k', 'ae', 't…          7     3 JJ         9.61 1.22e-5
6 s06   man       0.229 ['m', 'ae', 'n…          3     1 NN         6.48 1.70e-3
# ℹ 2 more variables: dist_end_iu &lt;dbl&gt;, pre_mention &lt;chr&gt;</code></pre>
</div>
</div>
<p>Let control for capitalization of words by uppercasing (v.) the words, and then printing the first six rows.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>buck <span class="ot">&lt;-</span> buck <span class="sc">%&gt;%</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">wd =</span> <span class="fu">str_to_upper</span>(wd))</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(buck)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 11
  file  wd       wd_dur segments        n_segments n_syl pos   spch_rate wd_freq
  &lt;chr&gt; &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;                &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;
1 s01   SHOW      0.195 ['sh', 'ow']             2     1 VBP       14.2  4.09e-4
2 s06   EVERYONE  0.418 ['eh', 'v', 'r…          7     3 NN        13.2  2.21e-4
3 s01   IS        0.103 ['uh', 'z']              2     1 VBZ       13.9  8.58e-3
4 s01   NATIONAL  0.394 ['n', 'ae', 's…          5     2 JJ        14.5  3.99e-5
5 s01   CATHOLIC  0.402 ['k', 'ae', 't…          7     3 JJ         9.61 1.22e-5
6 s06   MAN       0.229 ['m', 'ae', 'n…          3     1 NN         6.48 1.70e-3
# ℹ 2 more variables: dist_end_iu &lt;dbl&gt;, pre_mention &lt;chr&gt;</code></pre>
</div>
</div>
</section>
<section id="with-random-intercepts" class="level1">
<h1>With random intercepts</h1>
<p>Let’s fit a linear regression with random intercepts for speaker and for word, that is, a unique intercept for each speaker and a unique intercept for each word.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> lmerTest<span class="sc">::</span><span class="fu">lmer</span>(wd_dur <span class="sc">~</span> n_segments <span class="sc">+</span> spch_rate <span class="sc">+</span> wd_freq <span class="sc">+</span> dist_end_iu <span class="sc">+</span> pre_mention <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> file) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> wd), <span class="at">data =</span> buck)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Some predictor variables are on very different scales: consider
rescaling

Warning: Some predictor variables are on very different scales: consider
rescaling</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite's method [
lmerModLmerTest]
Formula: 
wd_dur ~ n_segments + spch_rate + wd_freq + dist_end_iu + pre_mention +  
    (1 | file) + (1 | wd)
   Data: buck

REML criterion at convergence: -5656.6

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.2602 -0.6204 -0.1445  0.4388  5.1113 

Random effects:
 Groups   Name        Variance  Std.Dev.
 wd       (Intercept) 0.0022806 0.04776 
 file     (Intercept) 0.0004753 0.02180 
 Residual             0.0050666 0.07118 
Number of obs: 2537, groups:  wd, 628; file, 6

Fixed effects:
                 Estimate Std. Error         df t value Pr(&gt;|t|)    
(Intercept)     1.830e-01  1.403e-02  2.813e+01  13.042 1.90e-13 ***
n_segments      4.944e-02  1.821e-03  9.637e+02  27.148  &lt; 2e-16 ***
spch_rate      -4.570e-03  5.137e-04  2.337e+03  -8.896  &lt; 2e-16 ***
wd_freq        -1.404e+01  2.671e+00  2.150e+02  -5.256 3.55e-07 ***
dist_end_iu     2.182e-04  2.973e-04  2.323e+03   0.734    0.463    
pre_mentionyes -6.215e-03  4.574e-03  2.450e+03  -1.359    0.174    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) n_sgmn spch_r wd_frq dst_n_
n_segments  -0.574                            
spch_rate   -0.419  0.020                     
wd_freq     -0.249  0.330  0.000              
dist_end_iu -0.020  0.012 -0.254 -0.015       
pre_mentnys -0.209  0.049 -0.007 -0.177 -0.009
fit warnings:
Some predictor variables are on very different scales: consider rescaling</code></pre>
</div>
</div>
<p>We get a warning message stating that the scales of some of the continuous predictor variables are on very different scales and that we should consider rescaling. Let’s take a look at summary information about all columns.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>buck <span class="sc">%&gt;%</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">map</span>(summary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$file
   Length     Class      Mode 
     2537 character character 

$wd
   Length     Class      Mode 
     2537 character character 

$wd_dur
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.0280  0.1700  0.2333  0.2563  0.3208  0.7480 

$segments
   Length     Class      Mode 
     2537 character character 

$n_segments
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  1.000   3.000   3.000   3.432   4.000  10.000 

$n_syl
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  1.000   1.000   1.000   1.304   2.000   5.000 

$pos
   Length     Class      Mode 
     2537 character character 

$spch_rate
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  2.841  10.557  12.567  12.530  14.484  33.333 

$wd_freq
     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
2.600e-08 2.149e-04 8.373e-04 1.778e-03 3.298e-03 8.583e-03 

$dist_end_iu
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  1.000   3.000   5.000   6.339   8.000  45.000 

$pre_mention
   Length     Class      Mode 
     2537 character character </code></pre>
</div>
</div>
<p>In general, it’s a good idea to use z-scores of continuous variables by using <a href="https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/scale">scale()</a>. It comes at the cost of losing some of the interpretability, as all we can really say is whether there is a significant effect, and if so, in what direction.<br><br> Let’s scale all the continuous variables and rerun the regression.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> lmerTest<span class="sc">::</span><span class="fu">lmer</span>(<span class="fu">scale</span>(wd_dur) <span class="sc">~</span> <span class="fu">scale</span>(n_segments) <span class="sc">+</span> <span class="fu">scale</span>(spch_rate) <span class="sc">+</span> <span class="fu">scale</span>(wd_freq) <span class="sc">+</span> <span class="fu">scale</span>(dist_end_iu) <span class="sc">+</span> pre_mention <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> file) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> wd), <span class="at">data =</span> buck)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite's method [
lmerModLmerTest]
Formula: 
scale(wd_dur) ~ scale(n_segments) + scale(spch_rate) + scale(wd_freq) +  
    scale(dist_end_iu) + pre_mention + (1 | file) + (1 | wd)
   Data: buck

REML criterion at convergence: 5182

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.2602 -0.6204 -0.1445  0.4388  5.1113 

Random effects:
 Groups   Name        Variance Std.Dev.
 wd       (Intercept) 0.16474  0.4059  
 file     (Intercept) 0.03434  0.1853  
 Residual             0.36598  0.6050  
Number of obs: 2537, groups:  wd, 628; file, 6

Fixed effects:
                     Estimate Std. Error         df t value Pr(&gt;|t|)    
(Intercept)         1.326e-01  8.828e-02  8.504e+00   1.502    0.169    
scale(n_segments)   5.607e-01  2.065e-02  9.637e+02  27.148  &lt; 2e-16 ***
scale(spch_rate)   -1.235e-01  1.388e-02  2.337e+03  -8.896  &lt; 2e-16 ***
scale(wd_freq)     -2.411e-01  4.587e-02  2.150e+02  -5.256 3.55e-07 ***
scale(dist_end_iu)  9.854e-03  1.343e-02  2.323e+03   0.734    0.463    
pre_mentionyes     -5.282e-02  3.887e-02  2.450e+03  -1.359    0.174    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) scl(n_) scl(s_) scl(w_) sc(__)
scl(n_sgmn) -0.008                               
scl(spch_r)  0.019  0.020                        
scl(wd_frq)  0.316  0.330   0.000                
scl(dst_n_) -0.003  0.012  -0.254  -0.015        
pre_mentnys -0.340  0.049  -0.007  -0.177  -0.009</code></pre>
</div>
</div>
<p>Let’s look at how much variability in the response variable (i.e., wd_dur) is accounted for by both the random effects and the fixed effects (i.e., conditional <span class="math inline">\(R^{2}\)</span>) and how much is accounted for by only the fixed effects (i.e., mariginal <span class="math inline">\(R^{2}\)</span>) with <a href="https://www.rdocumentation.org/packages/performance/versions/0.5.0/topics/r2_nakagawa">performance::r2_nakagawa()</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("performance")  # if needed, run this line first</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">r2_nakagawa</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># R2 for Mixed Models

  Conditional R2: 0.670
     Marginal R2: 0.490</code></pre>
</div>
</div>
</section>
<section id="without-random-intercepts" class="level1">
<h1>Without random intercepts</h1>
<p>For comparison purposes, let’s fit a linear regression model without any random effects. Compare the <span class="math inline">\(R^{2}\)</span> in this model with the marginal <span class="math inline">\(R^{2}\)</span> in the mixed-effects model above.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">scale</span>(wd_dur) <span class="sc">~</span> <span class="fu">scale</span>(n_segments) <span class="sc">+</span> <span class="fu">scale</span>(spch_rate) <span class="sc">+</span> <span class="fu">scale</span>(wd_freq) <span class="sc">+</span> <span class="fu">scale</span>(dist_end_iu) <span class="sc">+</span> pre_mention, <span class="at">data =</span> buck)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = scale(wd_dur) ~ scale(n_segments) + scale(spch_rate) + 
    scale(wd_freq) + scale(dist_end_iu) + pre_mention, data = buck)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.7399 -0.4904 -0.1134  0.3680  4.1878 

Coefficients:
                   Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)         0.14341    0.03482   4.118 3.94e-05 ***
scale(n_segments)   0.54739    0.01668  32.814  &lt; 2e-16 ***
scale(spch_rate)   -0.15918    0.01488 -10.696  &lt; 2e-16 ***
scale(wd_freq)     -0.16332    0.01716  -9.517  &lt; 2e-16 ***
scale(dist_end_iu)  0.01454    0.01488   0.977    0.329    
pre_mentionyes     -0.17653    0.03909  -4.516 6.59e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.7198 on 2531 degrees of freedom
Multiple R-squared:  0.4829,    Adjusted R-squared:  0.4818 
F-statistic: 472.7 on 5 and 2531 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section id="random-slopes-and-intercepts" class="level1">
<h1>Random slopes and intercepts</h1>
<p>In addition to allowing for different intercepts for the specific individuals selected from the population (e.g., speakers, word), you can also allow a linear model to fit different slopes for the individuals. Let’s rerun our mixed-effects model from above (i.e., ‘m2’), but this time with random slopes on a fixed effect variable of our interest.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>m4 <span class="ot">&lt;-</span> lmerTest<span class="sc">::</span><span class="fu">lmer</span>(<span class="fu">scale</span>(wd_dur) <span class="sc">~</span> <span class="fu">scale</span>(n_segments) <span class="sc">+</span> <span class="fu">scale</span>(spch_rate) <span class="sc">+</span> <span class="fu">scale</span>(wd_freq) <span class="sc">+</span> <span class="fu">scale</span>(dist_end_iu) <span class="sc">+</span> pre_mention <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> n_segments <span class="sc">|</span> file) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> n_segments <span class="sc">|</span> wd), <span class="at">data =</span> buck)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Model failed to converge with 2 negative eigenvalues: -3.4e+00
-2.1e+02</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite's method [
lmerModLmerTest]
Formula: 
scale(wd_dur) ~ scale(n_segments) + scale(spch_rate) + scale(wd_freq) +  
    scale(dist_end_iu) + pre_mention + (1 + n_segments | file) +  
    (1 + n_segments | wd)
   Data: buck

REML criterion at convergence: 5166.6

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.2941 -0.6246 -0.1515  0.4442  5.2959 

Random effects:
 Groups   Name        Variance Std.Dev. Corr
 wd       (Intercept) 0.000000 0.00000      
          n_segments  0.010776 0.10381   NaN
 file     (Intercept) 0.000000 0.00000      
          n_segments  0.003044 0.05517   NaN
 Residual             0.363106 0.60258      
Number of obs: 2537, groups:  wd, 628; file, 6

Fixed effects:
                     Estimate Std. Error         df t value Pr(&gt;|t|)    
(Intercept)           0.15589    0.08631    7.08067   1.806    0.113    
scale(n_segments)     0.59451    0.03813   11.77687  15.592 3.19e-09 ***
scale(spch_rate)     -0.11936    0.01376 2329.14824  -8.676  &lt; 2e-16 ***
scale(wd_freq)       -0.21256    0.03101   84.67876  -6.855 1.08e-09 ***
scale(dist_end_iu)    0.01004    0.01333 2302.09156   0.753    0.451    
pre_mentionyes       -0.06194    0.03869 2472.54020  -1.601    0.110    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) scl(n_) scl(s_) scl(w_) sc(__)
scl(n_sgmn)  0.743                               
scl(spch_r)  0.019  0.026                        
scl(wd_frq)  0.195  0.274  -0.003                
scl(dst_n_) -0.004  0.002  -0.256  -0.030        
pre_mentnys -0.336  0.050  -0.014  -0.184  -0.005
optimizer (nloptwrap) convergence code: 0 (OK)
boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">r2_nakagawa</span>(m4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Can't compute random effect variances. Some variance components equal
  zero. Your model may suffer from singularity (see `?lme4::isSingular`
  and `?performance::check_singularity`).
  Solution: Respecify random structure! You may also decrease the
  `tolerance` level to enforce the calculation of random effect variances.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Random effect variances not available. Returned R2 does not account for random effects.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># R2 for Mixed Models

  Conditional R2: NA
     Marginal R2: 0.607</code></pre>
</div>
</div>
<p>We get a warning message stating that our model suffers from singularity. This is often the case when one of our random effects has at least one level that only has only one token. Let’s see if we can resolve this warning by removing the random slope on word, but keeping in the random intercept.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>m4 <span class="ot">&lt;-</span> lmerTest<span class="sc">::</span><span class="fu">lmer</span>(<span class="fu">scale</span>(wd_dur) <span class="sc">~</span> <span class="fu">scale</span>(n_segments) <span class="sc">+</span> <span class="fu">scale</span>(spch_rate) <span class="sc">+</span> <span class="fu">scale</span>(wd_freq) <span class="sc">+</span> <span class="fu">scale</span>(dist_end_iu) <span class="sc">+</span> pre_mention <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> n_segments <span class="sc">|</span> file) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> wd), <span class="at">data =</span> buck)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite's method [
lmerModLmerTest]
Formula: 
scale(wd_dur) ~ scale(n_segments) + scale(spch_rate) + scale(wd_freq) +  
    scale(dist_end_iu) + pre_mention + (1 + n_segments | file) +      (1 | wd)
   Data: buck

REML criterion at convergence: 5157.4

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.3273 -0.6248 -0.1617  0.4528  5.2103 

Random effects:
 Groups   Name        Variance  Std.Dev. Corr 
 wd       (Intercept) 0.1606510 0.40081       
 file     (Intercept) 0.0002832 0.01683       
          n_segments  0.0034436 0.05868  -1.00
 Residual             0.3630763 0.60256       
Number of obs: 2537, groups:  wd, 628; file, 6

Fixed effects:
                     Estimate Std. Error         df t value Pr(&gt;|t|)    
(Intercept)         1.362e-01  8.782e-02  8.474e+00   1.551    0.157    
scale(n_segments)   5.822e-01  3.800e-02  7.157e+00  15.321 9.85e-07 ***
scale(spch_rate)   -1.224e-01  1.373e-02  2.286e+03  -8.919  &lt; 2e-16 ***
scale(wd_freq)     -2.429e-01  4.537e-02  2.128e+02  -5.353 2.23e-07 ***
scale(dist_end_iu)  8.919e-03  1.335e-02  2.323e+03   0.668    0.504    
pre_mentionyes     -5.827e-02  3.861e-02  2.442e+03  -1.509    0.131    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) scl(n_) scl(s_) scl(w_) sc(__)
scl(n_sgmn)  0.721                               
scl(spch_r)  0.019  0.023                        
scl(wd_frq)  0.314  0.178   0.000                
scl(dst_n_) -0.002  0.003  -0.256  -0.014        
pre_mentnys -0.342  0.030  -0.015  -0.177  -0.008</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">r2_nakagawa</span>(m4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># R2 for Mixed Models

  Conditional R2: 0.670
     Marginal R2: 0.523</code></pre>
</div>
</div>
<p>Sure enough, that resolved the singularity warning message.<br><br> As you can now see, by adding random slopes to the speakers, our marginal <span class="math inline">\(R^{2}\)</span> value increases, indicating that allowing the slopes to vary by speaker allows the fixed effect n_segment to better fit the data point.<br><br> <a href="https://stats.stackexchange.com/a/31634">Here</a>’s a good explanation of how to understand random slopes. <strong>Takehome message</strong>: It’s best to specify both random intercepts and slopes as they allow the model to better fit the data. However, it can often happen that you get a singularity warning with a random slope that has few tokens, and in that case, keeping only the random intercept is necessary.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">Copyright: Earl Kjar Brown, PhD</div>
  </div>
</footer>



</body></html>